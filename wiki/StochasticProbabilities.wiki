#summary Calculating probabilities stochastically
#labels math,docs,frameshifting

There are three probabilities to be computed: P.abc, P.bcd, and P.reloop where "abc" is the current codon, "bcd" is the next codon (if a frameshift occurs), and "reloop" is the action that occurs when we recalculate the probabilities, simulating the ribosome's staying in one place.

We know P.abc = 1 - P.fail.abc, so all we have to do is compute P.fail.abc, which obeys this simple equation: `P.fail' = P.fail * (1 - cos(displacement)^10/loops)` where P.fail' is the probability of failure at the next cycle and P.fail was the probability at the previous cycle. Thus, this is a cumulative model and is awesome. (Nloop is how long the ribosome stays at the codon.) In addition, `cos(displacement)^10`--or any even number--represents the window function. Nloops is regulated by the algorithm `loops = k/(k-1) where k = 2^(1/Nloop)` (cf. `real_loops` function in `displacement.m`).

At a certain codon "junction," the ribosome can choose to either stay at the "abc" frame or continue to the "bcd" frame or just wait and "reloop." In our model, we assume that these are the only three options represented by the probabilities. In order to choose the frame, we roll a "dice" and randomly choose on based on the weights of the probabilities.

We compute this once for P.abc and P.bcd.